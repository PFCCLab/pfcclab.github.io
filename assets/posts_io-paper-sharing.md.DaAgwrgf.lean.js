import{_ as r,c as a,q as e,a as Q,N as t,o as s}from"./chunks/framework.BRsttz9t.js";const l="/assets/image-1.DGcL4LEV.png",o="/assets/image-2.CXJuMXXn.png",n="/assets/image-3.Dkd4nBD3.png",d="/assets/image-4.C2lA8GSg.png",i="/assets/image-5.wPkKS_Af.png",H="/assets/image-6.BpYyWiWH.png",m="/assets/image-7.p5HvH12Z.png",h="/assets/image-8.Dtv9XPo1.png",p="/assets/image-9.BH1UNRjH.png",V="/assets/image-10.D5A1A579.png",L="/assets/image-11.LzlDeFM3.png",g="/assets/image-12.necBKmEr.png",c="/assets/image-13.CN49jiyr.png",u="/assets/image-14.CXI531NU.png",q=JSON.parse('{"title":"【论文分享】｜MoE 层训练推理的 I/O 相关优化策略","description":"","frontmatter":{"title":"【论文分享】｜MoE 层训练推理的 I/O 相关优化策略","date":"2025-07-29T00:00:00.000Z","author":{"name":"聂云涛","github":"GITD245"},"category":"insights"},"headers":[],"relativePath":"posts/io-paper-sharing.md","filePath":"posts/io-paper-sharing.md"}'),f={name:"posts/io-paper-sharing.md"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.359ex",height:"1.645ex",role:"img",focusable:"false",viewBox:"0 -705 14302.6 727","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.501ex",height:"2.081ex",role:"img",focusable:"false",viewBox:"0 -716 17901.6 920","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.349ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1922.4 840.8","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.091ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.142ex",height:"2.672ex",role:"img",focusable:"false",viewBox:"0 -698.8 3599 1180.9","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"49.921ex",height:"2.348ex",role:"img",focusable:"false",viewBox:"0 -833.9 22064.9 1037.9","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"61.791ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 27311.5 1083.9","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.14ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 504 683","aria-hidden":"true"};function E(j,T,U,G,O,I){return s(),a("div",null,[T[31]||(T[31]=e("",25)),Q("ul",null,[Q("li",null,[T[2]||(T[2]=Q("p",null,[t("算力 π：也称为计算平台的"),Q("strong",null,"性能上限"),t("，指的是一个计算平台倾尽全力每秒钟所能完成的浮点运算数。单位是 "),Q("code",null,"FLOP/s")],-1)),Q("p",null,[Q("mjx-container",w,[(s(),a("svg",M,[...T[0]||(T[0]=[e("",1)])])),T[1]||(T[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"π"),Q("mo",null,":"),Q("mtext",null,"Maximum FLOPs Per Second")])],-1))])])]),Q("li",null,[T[5]||(T[5]=Q("p",null,[t("带宽 β：也即计算平台的"),Q("strong",null,"带宽上限"),t("，指的是一个计算平台倾尽全力每秒所能完成的内存交换量。单位是"),Q("code",null,"Byte/s"),t("。")],-1)),T[6]||(T[6]=Q("p",null,"一般来说这里的带宽指的是访存速率，但实际上这里也可以看为一个包含通信速率在内的广义的带宽。",-1)),Q("p",null,[Q("mjx-container",k,[(s(),a("svg",y,[...T[3]||(T[3]=[e("",1)])])),T[4]||(T[4]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"β"),Q("mo",null,":"),Q("mtext",null,"Maximum Memory Access Per Second")])],-1))])])]),Q("li",null,[Q("p",null,[T[9]||(T[9]=Q("strong",null,[t("计算强度("),Q("strong",null,"Arithmetic Intensity"),t(")上限")],-1)),Q("mjx-container",x,[(s(),a("svg",Z,[...T[7]||(T[7]=[e("",1)])])),T[8]||(T[8]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"I"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x")])])])],-1))]),T[10]||(T[10]=t("：两个指标相除即可得到计算平台的",-1)),T[11]||(T[11]=Q("strong",null,"计算强度上限",-1)),T[12]||(T[12]=t("。它描述的是在这个计算平台上，单位内存交换最多用来进行多少次计算。单位是",-1)),T[13]||(T[13]=Q("code",null,"FLOPs/Byte",-1)),T[14]||(T[14]=t("。",-1))]),Q("p",null,[Q("mjx-container",b,[(s(),a("svg",C,[...T[15]||(T[15]=[e("",1)])])),T[16]||(T[16]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"I"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x")])]),Q("mo",null,":"),Q("mfrac",null,[Q("mi",null,"π"),Q("mi",null,"β")])])],-1))])])])]),T[32]||(T[32]=Q("p",null,[Q("strong",null,"模型的两个指标：计算量 与 访存量")],-1)),Q("ul",null,[Q("li",null,[T[19]||(T[19]=Q("p",null,[Q("strong",null,[t("计算量："),Q("strong",null,"指的是输入单个样本（对于 CNN 而言就是一张图像），模型进行一次完整的前向传播所发生的浮点运算个数，也即模型的"),t("时间复杂度")]),t("。单位是 "),Q("code",null,"#FLOP"),t("。其中卷积层的计算量公式如下")],-1)),Q("p",null,[Q("mjx-container",P,[(s(),a("svg",_,[...T[17]||(T[17]=[e("",1)])])),T[18]||(T[18]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mtext",null,"Conv Layer Time Complexity"),Q("mo",null,":"),Q("msup",null,[Q("mi",null,"M"),Q("mn",null,"2")]),Q("mo",null,"⋅"),Q("msup",null,[Q("mi",null,"K"),Q("mn",null,"2")]),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"C"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mi",null,"n")])]),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"C"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"o"),Q("mi",null,"u"),Q("mi",null,"t")])])])],-1))])])]),Q("li",null,[T[22]||(T[22]=Q("p",null,[Q("strong",null,[t("访存量："),Q("strong",null,"指的是输入单个样本，模型完成一次前向传播过程中所发生的内存交换总量，也即模型的"),t("空间复杂度")]),t("。在理想情况下（即不考虑片上缓存），模型的访存量就是模型各层"),Q("strong",null,"权重参数"),t("的内存占用（Kernel Mem）与每层所输出的"),Q("strong",null,"特征图"),t("的内存占用（Output Mem）之和。单位是"),Q("code",null,"Bytes"),t("。由于数据类型通常为"),Q("code",null,"float32"),t(" ，因此需要乘以四。")],-1)),Q("p",null,[Q("mjx-container",v,[(s(),a("svg",D,[...T[20]||(T[20]=[e("",1)])])),T[21]||(T[21]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mtext",null,"Conv Layer Space Complexity"),Q("mo",null,":"),Q("mo",{stretchy:"false"},"("),Q("msup",null,[Q("mi",null,"K"),Q("mn",null,"2")]),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"C"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mi",null,"n")])]),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"C"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"o"),Q("mi",null,"u"),Q("mi",null,"t")])]),Q("mo",null,"+"),Q("msup",null,[Q("mi",null,"M"),Q("mn",null,"2")]),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"C"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"o"),Q("mi",null,"u"),Q("mi",null,"t")])]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mn",null,"4")])],-1))])])]),Q("li",null,[Q("p",null,[T[25]||(T[25]=Q("strong",null,"模型的计算强度",-1)),Q("mjx-container",S,[(s(),a("svg",A,[...T[23]||(T[23]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D43C",d:"M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z",style:{"stroke-width":"3"}})])])],-1)])])),T[24]||(T[24]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"I")])],-1))]),T[26]||(T[26]=t("：由计算量除以访存量就可以得到模型的计算强度，它表示此模型在计算过程中，每",-1)),T[27]||(T[27]=Q("code",null,"Byte",-1)),T[28]||(T[28]=t("内存交换到底用于进行多少次浮点运算。单位是",-1)),T[29]||(T[29]=Q("code",null,"FLOPs/Byte",-1)),T[30]||(T[30]=t("。可以看到，模计算强度越大，其内存使用效率越高。",-1))])])]),T[33]||(T[33]=e("",25))])}const B=r(f,[["render",E]]);export{q as __pageData,B as default};
