import{_ as n,c as m,a as Q,m as t,L as a,o as l}from"./chunks/framework.CcfPirFf.js";const d="/assets/attention_sink_example_small.CqZYh014.png",s="/assets/attention_sink_fig_2.DmQG5cfc.png",e="/assets/attention_sink_fig_3.C9Ea9G0E.png",o="/assets/attention_sink_table_1.CoGQ6N1r.png",r="/assets/attention_sink_optimization.DCs-Dqat.png",H="/assets/attention_sink_fixed_position_small.CSsxvj66.png",g="/assets/attention_sink_norm_small.Bw87N39b.png",i="/assets/attention_sink_table_4.BlNx1ahl.png",p="/assets/attention_sink_model.CQ0kYR3K.png",h="/assets/attention_sink_lm_wo_sink_small._GeZRUOz.png",o2=JSON.parse('{"title":"【论文分享】｜Attention Sink 何时出现在语言模型中？","description":"","frontmatter":{"title":"【论文分享】｜Attention Sink 何时出现在语言模型中？","date":"2025-06-13T00:00:00.000Z","author":{"name":"娄司宇","github":"LLSGYN"},"category":"insights"},"headers":[],"relativePath":"posts/attnsink-paper-sharing.md","filePath":"posts/attnsink-paper-sharing.md"}'),V={name:"posts/attnsink-paper-sharing.md"},L={id:"mjx-f660487"},u={class:"MathJax",jax:"SVG",style:{position:"relative"}},x={style:{"vertical-align":"-1.469ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.727ex",height:"4.07ex",role:"img",focusable:"false",viewBox:"0 -1149.5 9603.3 1799","aria-hidden":"true"},c={id:"mjx-35be193"},M={class:"MathJax",jax:"SVG",style:{position:"relative"}},f={style:{"vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.291ex",height:"2.601ex",role:"img",focusable:"false",viewBox:"0 -853.7 1012.6 1149.4","aria-hidden":"true"},Z={id:"mjx-9fde2a1"},w={class:"MathJax",jax:"SVG",style:{position:"relative"}},D={style:{"vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.291ex",height:"2.601ex",role:"img",focusable:"false",viewBox:"0 -853.7 1012.6 1149.4","aria-hidden":"true"},_={id:"mjx-69957fb"},j={class:"MathJax",jax:"SVG",style:{position:"relative"}},b={style:{"vertical-align":"-0.673ex"},xmlns:"http://www.w3.org/2000/svg",width:"37.082ex",height:"2.714ex",role:"img",focusable:"false",viewBox:"0 -902.3 16390.3 1199.6","aria-hidden":"true"},v={id:"mjx-a415cb"},k={class:"MathJax",jax:"SVG",style:{position:"relative"}},A={style:{"vertical-align":"-0.765ex"},xmlns:"http://www.w3.org/2000/svg",width:"42.816ex",height:"2.806ex",role:"img",focusable:"false",viewBox:"0 -902.3 18924.9 1240.5","aria-hidden":"true"},R={id:"mjx-fd142b5"},O={class:"MathJax",jax:"SVG",style:{position:"relative"}},C={style:{"vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.291ex",height:"2.601ex",role:"img",focusable:"false",viewBox:"0 -853.7 1012.6 1149.4","aria-hidden":"true"},S={id:"mjx-2e15e68"},y={class:"MathJax",jax:"SVG",style:{position:"relative"}},E={style:{"vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.662ex",height:"1.91ex",role:"img",focusable:"false",viewBox:"0 -694 734.6 844","aria-hidden":"true"},P={id:"mjx-cb62b6e"},N={class:"MathJax",jax:"SVG",style:{position:"relative"}},X={style:{"vertical-align":"-1.093ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.113ex",height:"3.024ex",role:"img",focusable:"false",viewBox:"0 -853.7 1817.9 1336.8","aria-hidden":"true"},I={id:"mjx-e1b2603"},B={class:"MathJax",jax:"SVG",style:{position:"relative"}},G={style:{"vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.662ex",height:"1.91ex",role:"img",focusable:"false",viewBox:"0 -694 734.6 844","aria-hidden":"true"},q={id:"mjx-8b4014f"},J={class:"MathJax",jax:"SVG",style:{position:"relative"}},F={style:{"vertical-align":"-0.437ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.993ex",height:"2.011ex",role:"img",focusable:"false",viewBox:"0 -696 1765 889","aria-hidden":"true"},K={id:"mjx-a12b134"},W={class:"MathJax",jax:"SVG",style:{position:"relative"}},z={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637","aria-hidden":"true"},$={id:"mjx-6f1f28b"},Y={class:"MathJax",jax:"SVG",style:{position:"relative"}},U={style:{"vertical-align":"-0.673ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.673ex",height:"3.376ex",role:"img",focusable:"false",viewBox:"0 -1195.1 3391.4 1492.4","aria-hidden":"true"},Q1={id:"mjx-3ccf8a4"},T1={class:"MathJax",jax:"SVG",style:{position:"relative"}},a1={style:{"vertical-align":"-1.097ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.534ex",height:"3.8ex",role:"img",focusable:"false",viewBox:"0 -1195.1 3771.8 1679.8","aria-hidden":"true"},t1={id:"mjx-52e9e27"},m1={class:"MathJax",jax:"SVG",style:{position:"relative"}},l1={style:{"vertical-align":"-0.991ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.06ex",height:"3.46ex",role:"img",focusable:"false",viewBox:"0 -1091.5 15496.5 1529.5","aria-hidden":"true"},n1={id:"mjx-22889e"},d1={class:"MathJax",jax:"SVG",style:{position:"relative"}},s1={style:{"vertical-align":"-0.673ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.555ex",height:"2.893ex",role:"img",focusable:"false",viewBox:"0 -981.5 5549.3 1278.8","aria-hidden":"true"},e1={id:"mjx-b9eae9"},o1={class:"MathJax",jax:"SVG",style:{position:"relative"}},r1={style:{"vertical-align":"-0.673ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.189ex",height:"2.893ex",role:"img",focusable:"false",viewBox:"0 -981.5 5387.5 1278.8","aria-hidden":"true"},H1={id:"mjx-0bdd70b"},g1={class:"MathJax",jax:"SVG",style:{position:"relative"}},i1={style:{"vertical-align":"-0.673ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.209ex",height:"2.893ex",role:"img",focusable:"false",viewBox:"0 -981.5 1418.6 1278.8","aria-hidden":"true"},p1={id:"mjx-90c1425"},h1={class:"MathJax",jax:"SVG",style:{position:"relative"}},V1={style:{"vertical-align":"-0.626ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.186ex",height:"2.847ex",role:"img",focusable:"false",viewBox:"0 -981.5 1408.3 1258.3","aria-hidden":"true"},L1={id:"mjx-0d3eef"},u1={class:"MathJax",jax:"SVG",style:{position:"relative"}},x1={style:{"vertical-align":"-1.028ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.698ex",height:"3.248ex",role:"img",focusable:"false",viewBox:"0 -981.5 10032.6 1435.8","aria-hidden":"true"},c1={id:"mjx-a544dcc"},M1={class:"MathJax",jax:"SVG",style:{position:"relative"}},f1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.919ex",height:"1ex",role:"img",focusable:"false",viewBox:"0 -431 406 442","aria-hidden":"true"},Z1={id:"mjx-49d1199"},w1={class:"MathJax",jax:"SVG",style:{position:"relative"}},D1={style:{"vertical-align":"-0.673ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.414ex",height:"2.893ex",role:"img",focusable:"false",viewBox:"0 -981.5 3277.1 1278.8","aria-hidden":"true"},_1={id:"mjx-0489e08"},j1={class:"MathJax",jax:"SVG",style:{position:"relative"}},b1={style:{"vertical-align":"-0.781ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.712ex",height:"3.001ex",role:"img",focusable:"false",viewBox:"0 -981.5 15784.6 1326.5","aria-hidden":"true"},v1={id:"mjx-4ca89fb"},k1={class:"MathJax",jax:"SVG",style:{position:"relative"}},A1={style:{"vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.103ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 2697.4 636","aria-hidden":"true"},R1={id:"mjx-9ba3c1"},O1={class:"MathJax",jax:"SVG",style:{position:"relative"}},C1={style:{"vertical-align":"-0.791ex"},xmlns:"http://www.w3.org/2000/svg",width:"66.716ex",height:"2.722ex",role:"img",focusable:"false",viewBox:"0 -853.7 29488.5 1203.2","aria-hidden":"true"},S1={id:"mjx-34db6f7"},y1={class:"MathJax",jax:"SVG",style:{position:"relative"}},E1={style:{"vertical-align":"-0.791ex"},xmlns:"http://www.w3.org/2000/svg",width:"73.655ex",height:"2.722ex",role:"img",focusable:"false",viewBox:"0 -853.7 32555.5 1203.2","aria-hidden":"true"},P1={id:"mjx-fe702f4"},N1={class:"MathJax",jax:"SVG",style:{position:"relative"}},X1={style:{"vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.522ex",height:"2.117ex",role:"img",focusable:"false",viewBox:"0 -853.7 3766.7 935.7","aria-hidden":"true"},I1={id:"mjx-2450fbe"},B1={class:"MathJax",jax:"SVG",style:{position:"relative"}},G1={style:{"vertical-align":"-1.469ex"},xmlns:"http://www.w3.org/2000/svg",width:"87.94ex",height:"4.518ex",role:"img",focusable:"false",viewBox:"0 -1347.5 38869.7 1997","aria-hidden":"true"},q1={id:"mjx-b471ee5"},J1={class:"MathJax",jax:"SVG",style:{position:"relative"}},F1={style:{"vertical-align":"-1.469ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.204ex",height:"4.07ex",role:"img",focusable:"false",viewBox:"0 -1149.5 13350.2 1799","aria-hidden":"true"},K1={id:"mjx-e301f02"},W1={class:"MathJax",jax:"SVG",style:{position:"relative"}},z1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.738ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1652 1000","aria-hidden":"true"},$1={id:"mjx-b4b108"},Y1={class:"MathJax",jax:"SVG",style:{position:"relative"}},U1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.738ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1652 1000","aria-hidden":"true"},Q2={id:"mjx-a362855"},T2={class:"MathJax",jax:"SVG",style:{position:"relative"}},a2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.429ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3283.7 1000","aria-hidden":"true"};function t2(m2,T,l2,n2,d2,s2){return l(),m("div",null,[T[113]||(T[113]=Q("p",null,[a("论文链接："),Q("strong",null,[a("[ICLR 2025] "),Q("a",{href:"https://arxiv.org/abs/2410.10781",target:"_blank",rel:"noreferrer"},"WHEN ATTENTION SINK EMERGES IN LANGUAGE MODELS: AN EMPIRICAL VIEW")])],-1)),T[114]||(T[114]=Q("p",null,[a("Github 仓库："),Q("a",{href:"https://github.com/sail-sg/Attention-Sink",target:"_blank",rel:"noreferrer"},"https://github.com/sail-sg/Attention-Sink")],-1)),T[115]||(T[115]=Q("h2",{id:"什么是-attention-sink",tabindex:"-1"},[a("什么是 Attention Sink？ "),Q("a",{class:"header-anchor",href:"#什么是-attention-sink","aria-label":'Permalink to "什么是 Attention Sink？"'},"​")],-1)),Q("p",null,[T[2]||(T[2]=a("在 LLM 计算时，经常会为一些特定的 token 位置分配非常高的 attention score，从而在这些 token 位置形成垂直的 attention pattern。最常见的位置就是首 token，可以形式化表达为 ",-1)),Q("span",L,[Q("mjx-container",u,[(l(),m("svg",x,[...T[0]||(T[0]=[t("",1)])])),T[1]||(T[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"A")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",null,"≫"),Q("mtext",null,"mean"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("msubsup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"A")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j"),Q("mo",null,"≠"),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))])]),T[3]||(T[3]=a(" 。",-1))]),T[116]||(T[116]=t("",5)),Q("p",null,[T[6]||(T[6]=a("因此 ",-1)),Q("span",c,[Q("mjx-container",M,[(l(),m("svg",f,[...T[4]||(T[4]=[t("",1)])])),T[5]||(T[5]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"h"),Q("mn",null,"1"),Q("mi",null,"l")])])],-1))])]),T[7]||(T[7]=a(" 以及相应的 Q、K、V 可以视为直接从 word embedding 得到的 MLP 输出。",-1))]),Q("ul",null,[Q("li",null,[Q("p",null,[T[10]||(T[10]=a("计算特性： ",-1)),Q("span",Z,[Q("mjx-container",w,[(l(),m("svg",D,[...T[8]||(T[8]=[t("",1)])])),T[9]||(T[9]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"h"),Q("mn",null,"1"),Q("mi",null,"l")])])],-1))])]),T[11]||(T[11]=a(" 以及相应的 Q、K、V 可以视为直接从 word embedding 得到的 MLP 输出。",-1))]),Q("ul",null,[Q("li",null,[T[16]||(T[16]=a("首 token 和其他后续的 token 计算有一个显著不同：第一个 hidden state 的计算不涉及 self-attention ",-1)),Q("span",_,[Q("mjx-container",j,[(l(),m("svg",b,[...T[12]||(T[12]=[t("",1)])])),T[13]||(T[13]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"h"),Q("mn",null,"1"),Q("mi",null,"l")]),Q("mo",null,"="),Q("mtext",null,"FFN"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"LN"),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"o"),Q("mn",null,"1"),Q("mi",null,"l")]),Q("mo",null,"+"),Q("msubsup",null,[Q("mi",null,"h"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"+"),Q("msubsup",null,[Q("mi",null,"o"),Q("mn",null,"1"),Q("mi",null,"l")]),Q("mo",null,"+"),Q("msubsup",null,[Q("mi",null,"h"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])])])],-1))])]),T[17]||(T[17]=a(" ， ",-1)),Q("span",v,[Q("mjx-container",k,[(l(),m("svg",A,[...T[14]||(T[14]=[t("",1)])])),T[15]||(T[15]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"o"),Q("mn",null,"1"),Q("mi",null,"l")]),Q("mo",null,"="),Q("mtext",null,"LN"),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"h"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"["),Q("msup",null,[Q("mi",null,"W"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mn",null,"1")])]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("msup",null,[Q("mi",null,"W"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mn",null,"2")])]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",null,"…"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("msup",null,[Q("mi",null,"W"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"H")])]),Q("mo",{stretchy:"false"},"]"),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"O"),Q("mi",null,"l")])])],-1))])]),T[18]||(T[18]=a(" 。",-1))])])]),Q("li",null,[Q("p",null,[T[25]||(T[25]=a("数值特性：从特定层开始， ",-1)),Q("span",R,[Q("mjx-container",O,[(l(),m("svg",C,[...T[19]||(T[19]=[t("",1)])])),T[20]||(T[20]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"h"),Q("mn",null,"1"),Q("mi",null,"l")])])],-1))])]),T[26]||(T[26]=a(" 的 ",-1)),Q("span",S,[Q("mjx-container",y,[(l(),m("svg",E,[...T[21]||(T[21]=[t("",1)])])),T[22]||(T[22]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"l")]),Q("mn",null,"2")])])],-1))])]),T[27]||(T[27]=a(" 范数会显著大于其他 token ",-1)),Q("span",P,[Q("mjx-container",N,[(l(),m("svg",X,[...T[23]||(T[23]=[t("",1)])])),T[24]||(T[24]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"h"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"t"),Q("mo",null,"≠"),Q("mn",null,"1")]),Q("mi",null,"l")])])],-1))])]),T[28]||(T[28]=a(" 。",-1))])]),Q("li",null,[Q("p",null,[T[31]||(T[31]=a("key, value 数值：第一个 token 的 key/value ",-1)),Q("span",I,[Q("mjx-container",B,[(l(),m("svg",G,[...T[29]||(T[29]=[t("",1)])])),T[30]||(T[30]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"l")]),Q("mn",null,"2")])])],-1))])]),T[32]||(T[32]=a(" 范数显著小于同一图中其他 token 的对应值。",-1))])])]),T[117]||(T[117]=Q("p",null,[Q("img",{src:s,alt:""})],-1)),Q("p",null,[Q("strong",null,[Q("span",q,[Q("mjx-container",J,[(l(),m("svg",F,[...T[33]||(T[33]=[t("",1)])])),T[34]||(T[34]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"QK")])])],-1))])]),T[35]||(T[35]=a(" 的角度促进了 attention sink",-1))])]),Q("p",null,[T[42]||(T[42]=a("对于第 ",-1)),Q("span",K,[Q("mjx-container",W,[(l(),m("svg",z,[...T[36]||(T[36]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D461",d:"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"})])])],-1)])])),T[37]||(T[37]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"t")])],-1))])]),T[43]||(T[43]=a(" 个 query， ",-1)),Q("span",$,[Q("mjx-container",Y,[(l(),m("svg",U,[...T[38]||(T[38]=[t("",1)])])),T[39]||(T[39]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msubsup",null,[Q("mi",null,"k"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"sans-serif"},"T")])])])])],-1))])]),T[44]||(T[44]=a(" 通常比 ",-1)),Q("span",Q1,[Q("mjx-container",T1,[(l(),m("svg",a1,[...T[40]||(T[40]=[t("",1)])])),T[41]||(T[41]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msubsup",null,[Q("mi",null,"k"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"≠"),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"sans-serif"},"T")])])])])],-1))])]),T[45]||(T[45]=a(" 具有更大的值，考察促成这一现象的原因。注意到，qk 内积可以表示为：",-1))]),Q("p",null,[Q("span",t1,[Q("mjx-container",m1,[(l(),m("svg",l1,[...T[46]||(T[46]=[t("",1)])])),T[47]||(T[47]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("msup",null,[Q("mi",null,"h"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"sans-serif"},"T")])])])])]),Q("mo",null,"="),Q("mo",{"data-mjx-texclass":"ORD"},"∥"),Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",{"data-mjx-texclass":"ORD"},"∥"),Q("mo",{"data-mjx-texclass":"ORD"},"∥"),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",{"data-mjx-texclass":"ORD"},"∥"),Q("mo",null,"⋅"),Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",{stretchy:"false"},")")])],-1))])])]),T[118]||(T[118]=Q("p",null,"从 Fig2 的结果可以发现：",-1)),Q("ul",null,[Q("li",null,[T[50]||(T[50]=a("l2 范数的乘积 ",-1)),Q("span",n1,[Q("mjx-container",d1,[(l(),m("svg",s1,[...T[48]||(T[48]=[t("",1)])])),T[49]||(T[49]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{"data-mjx-texclass":"ORD"},"∥"),Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",{"data-mjx-texclass":"ORD"},"∥"),Q("mo",null,"⋅"),Q("mo",{"data-mjx-texclass":"ORD"},"∥"),Q("msubsup",null,[Q("mi",null,"k"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",{"data-mjx-texclass":"ORD"},"∥")])],-1))])]),T[51]||(T[51]=a(" 较小。",-1))]),Q("li",null,[T[54]||(T[54]=a("角度项 ",-1)),Q("span",e1,[Q("mjx-container",o1,[(l(),m("svg",r1,[...T[52]||(T[52]=[t("",1)])])),T[53]||(T[53]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"k"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",{stretchy:"false"},")")])],-1))])]),T[55]||(T[55]=a(" 非常大，导致了 attention sink。",-1))])]),Q("p",null,[T[60]||(T[60]=a("第一个词符利用其 key 作为偏置（bias），从而最小化 ",-1)),Q("span",H1,[Q("mjx-container",g1,[(l(),m("svg",i1,[...T[56]||(T[56]=[t("",1)])])),T[57]||(T[57]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"k"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])])])],-1))])]),T[61]||(T[61]=a(" 和 ",-1)),Q("span",p1,[Q("mjx-container",h1,[(l(),m("svg",V1,[...T[58]||(T[58]=[t("",1)])])),T[59]||(T[59]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"q"),Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])])])],-1))])]),T[62]||(T[62]=a(" 之间的角度，并表现出 attention sink。",-1))]),T[119]||(T[119]=Q("h3",{id:"二、attention-sink-的测量方法",tabindex:"-1"},[a("二、Attention Sink 的测量方法 "),Q("a",{class:"header-anchor",href:"#二、attention-sink-的测量方法","aria-label":'Permalink to "二、Attention Sink 的测量方法"'},"​")],-1)),T[120]||(T[120]=Q("ul",null,[Q("li",null,"基于可视化的方法：绘制出 num_head * num_layers 个图像，难以处理。"),Q("li",null,"设计一个观测 attention head 的评估指标。")],-1)),T[121]||(T[121]=Q("p",null,"计算 k-th token 的重要性分数：",-1)),Q("p",null,[Q("span",L1,[Q("mjx-container",u1,[(l(),m("svg",x1,[...T[63]||(T[63]=[t("",1)])])),T[64]||(T[64]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"α"),Q("mi",null,"k"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",null,"="),Q("mfrac",null,[Q("mn",null,"1"),Q("mrow",null,[Q("mi",null,"T"),Q("mo",null,"−"),Q("mi",null,"k"),Q("mo",null,"+"),Q("mn",null,"1")])]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mi",null,"k")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"T")])]),Q("msubsup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"A")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"k")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])])])],-1))])])]),Q("p",null,[T[69]||(T[69]=a("首先考虑首 token 的情况。给定阈值 ",-1)),Q("span",c1,[Q("mjx-container",M1,[(l(),m("svg",f1,[...T[65]||(T[65]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D716",d:"M227 -11Q149 -11 95 41T40 174Q40 262 87 322Q121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411Q382 385 341 385H325H312Q191 385 154 277L150 265H327Q340 256 340 246Q340 228 320 219H138V217Q128 187 128 143Q128 77 160 52T231 26Q258 26 284 36T326 57T343 68Q350 68 354 58T358 39Q358 36 357 35Q354 31 337 21T289 0T227 -11Z"})])])],-1)])])),T[66]||(T[66]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"ϵ")])],-1))])]),T[70]||(T[70]=a(" ，称一个 head 中存在 attention sink 如果首 token 的重要性分数 ",-1)),Q("span",Z1,[Q("mjx-container",w1,[(l(),m("svg",D1,[...T[67]||(T[67]=[t("",1)])])),T[68]||(T[68]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"α"),Q("mn",null,"1"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",null,">"),Q("mi",null,"ϵ")])],-1))])]),T[71]||(T[71]=a(" 。",-1))]),T[122]||(T[122]=Q("p",null,"计算 LM 的 attention sink 情况：",-1)),Q("p",null,[Q("span",_1,[Q("mjx-container",j1,[(l(),m("svg",b1,[...T[72]||(T[72]=[t("",1)])])),T[73]||(T[73]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mtext",null,"Sink"),Q("mi",null,"k"),Q("mi",null,"ϵ")]),Q("mo",null,"="),Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"L")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"L")])]),Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"H")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"H")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"double-struck"},"I")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"α"),Q("mi",null,"k"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",null,">"),Q("mi",null,"ϵ"),Q("mo",{stretchy:"false"},")"),Q("mo",null,".")])],-1))])])]),T[123]||(T[123]=t("",10)),Q("ul",null,[T[81]||(T[81]=Q("li",null,[a("当 LM 在"),Q("strong",null,"充足的训练数据"),a("上得到有效训练后，attention sink 开始显现 。")],-1)),Q("li",null,[T[76]||(T[76]=a("通过修改数据分布 ",-1)),Q("span",v1,[Q("mjx-container",k1,[(l(),m("svg",A1,[...T[74]||(T[74]=[t("",1)])])),T[75]||(T[75]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mtext",null,"DATA")])])],-1))])]),T[77]||(T[77]=a(" ​，可以将 attention sink 的位置",-1)),T[78]||(T[78]=Q("strong",null,"从第一个 token 转移到其他位置",-1)),T[79]||(T[79]=a("。 ",-1)),T[80]||(T[80]=Q("ul",null,[Q("li",null,"即使将第一个 token 随机重采样，attention sink 依然存在，甚至可能更明显 。"),Q("li",null,"如果将输入序列的前几个 token 都进行随机重采样，sink token 的位置可能会发生改变 。")],-1))])]),T[124]||(T[124]=t("",8)),Q("ul",null,[T[91]||(T[91]=Q("li",null,[Q("p",null,"位置编码的种类："),Q("ul",null,[Q("li",null,"测试了多种位置编码方式（包括无位置编码 NoPE、绝对位置编码、可学习位置编码、ALiBi 和 RoPE），结果显示，所有采用这些编码方式的语言模型，甚至那些没有明确位置编码的模型，都出现了 attention sink 。")])],-1)),Q("li",null,[T[90]||(T[90]=Q("p",null,"Pre-Norm vs Post-Norm",-1)),Q("ul",null,[Q("li",null,[T[84]||(T[84]=a("Pre-norm： ",-1)),Q("span",R1,[Q("mjx-container",O1,[(l(),m("svg",C1,[...T[82]||(T[82]=[t("",1)])])),T[83]||(T[83]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mi",null,"l")]),Q("mo",null,"="),Q("mtext",null,"FFN"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtext",null,"LN"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"O")]),Q("mi",null,"l")]),Q("mo",null,"+"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",null,"+"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"O")]),Q("mi",null,"l")]),Q("mo",null,"+"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",null,","),Q("mtext",null," "),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"O")]),Q("mi",null,"l")]),Q("mo",null,"="),Q("mtext",null,"MHSA"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"LN"),Q("mo",{stretchy:"false"},"("),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")")])],-1))])])]),Q("li",null,[T[87]||(T[87]=a("Post-norm： ",-1)),Q("span",S1,[Q("mjx-container",y1,[(l(),m("svg",E1,[...T[85]||(T[85]=[t("",1)])])),T[86]||(T[86]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mi",null,"l")]),Q("mo",null,"="),Q("mtext",null,"LN"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtext",null,"FFN"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtext",null,"LN"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"O")]),Q("mi",null,"l")]),Q("mo",null,"+"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",null,"+"),Q("mtext",null,"LN"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"O")]),Q("mi",null,"l")]),Q("mo",null,"+"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",null,","),Q("mtext",null," "),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"O")]),Q("mi",null,"l")]),Q("mo",null,"="),Q("mtext",null,"MHSA"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"H")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mo",null,"−"),Q("mn",null,"1")])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))])])]),T[88]||(T[88]=Q("li",null,"Pre-norm 结构中，hidden state 的数值可以由 residual connection 在层间传播。一层出现了 massive value 后，后面的层也很有可能保留。",-1)),T[89]||(T[89]=Q("li",null,"无论是 pre-norm 还是 post-norm，attention sink 都会存在。Post-norm 的 massive vlue 出现在了 Post-LN 之前。",-1))])])]),T[125]||(T[125]=Q("p",null,[Q("img",{src:g,alt:""})],-1)),T[126]||(T[126]=Q("ul",null,[Q("li",null,"Attention sink 更像是一种“key bias”")],-1)),T[127]||(T[127]=Q("p",null,[Q("img",{src:i,alt:""})],-1)),Q("p",null,[T[94]||(T[94]=a("通过引入可学习的 sink token（作为 implicit bias）或直接在注意力机制中添加可学习的键值偏置 (KV biases) 或仅键偏置 (K biases, 此时 ",-1)),Q("span",P1,[Q("mjx-container",N1,[(l(),m("svg",X1,[...T[92]||(T[92]=[t("",1)])])),T[93]||(T[93]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"v")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"⋆"),Q("mi",null,"l"),Q("mo",null,","),Q("mi",null,"h")])]),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",{mathvariant:"bold"},"0")])])],-1))])]),T[95]||(T[95]=a(" )，可以将 sink token 从第一个 token 转移到这些引入的 bias 上，且不会损害模型性能 。而仅使用 value bias 则做不到，sink 会回到第一个 token。",-1))]),T[128]||(T[128]=Q("h2",{id:"attention-形式的影响",tabindex:"-1"},[a("Attention 形式的影响 "),Q("a",{class:"header-anchor",href:"#attention-形式的影响","aria-label":'Permalink to "Attention 形式的影响"'},"​")],-1)),T[129]||(T[129]=Q("p",null,[Q("strong",null,"Attention 的一般形式：")],-1)),Q("p",null,[Q("span",I1,[Q("mjx-container",B1,[(l(),m("svg",G1,[...T[96]||(T[96]=[t("",1)])])),T[97]||(T[97]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"v"),Q("mi",null,"i"),Q("mo",null,"†")]),Q("mo",null,"="),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"j"),Q("mo",{"data-mjx-alternate":"1"},"′")]),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"i")]),Q("mtext",null,"sim"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"k"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"j"),Q("mo",{"data-mjx-alternate":"1"},"′")])])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"1")])]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"i")]),Q("mtext",null,"sim"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")]),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"Z"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"1")])]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"i")]),Q("mtext",null,"sim"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")])])],-1))])])]),Q("p",null,[T[102]||(T[102]=a("对于 Softmax-attention， ",-1)),Q("span",q1,[Q("mjx-container",J1,[(l(),m("svg",F1,[...T[98]||(T[98]=[t("",1)])])),T[99]||(T[99]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mtext",null,"sim"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"q")]),Q("mi",null,"i")]),Q("mo",null,","),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"k")]),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"exp"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"q")]),Q("mi",null,"i")]),Q("msubsup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"bold"},"k")]),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"h")])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))])]),T[103]||(T[103]=a(" , ",-1)),Q("span",K1,[Q("mjx-container",W1,[(l(),m("svg",z1,[...T[100]||(T[100]=[t("",1)])])),T[101]||(T[101]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("mo",null,"⋅"),Q("mo",{stretchy:"false"},")")])],-1))])]),T[104]||(T[104]=a(" 是 identity kernel。",-1))]),T[130]||(T[130]=Q("p",null,"设计空间：",-1)),Q("ul",null,[Q("li",null,[T[107]||(T[107]=a("kernel function ",-1)),Q("span",$1,[Q("mjx-container",Y1,[(l(),m("svg",U1,[...T[105]||(T[105]=[t("",1)])])),T[106]||(T[106]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"ϕ"),Q("mo",{stretchy:"false"},"("),Q("mo",null,"⋅"),Q("mo",{stretchy:"false"},")")])],-1))])]),T[108]||(T[108]=a(" ：elu plus one; identity; MLP;",-1))]),Q("li",null,[T[111]||(T[111]=a("相似度函数 ",-1)),Q("span",Q2,[Q("mjx-container",T2,[(l(),m("svg",a2,[...T[109]||(T[109]=[t("",1)])])),T[110]||(T[110]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline"},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mtext",null,"sim"),Q("mo",{stretchy:"false"},"("),Q("mo",null,"⋅"),Q("mo",null,","),Q("mo",null,"⋅"),Q("mo",{stretchy:"false"},")")])],-1))])])]),T[112]||(T[112]=Q("li",null,"是否使用归一化项",-1))]),T[131]||(T[131]=t("",10))])}const r2=n(V,[["render",t2]]);export{o2 as __pageData,r2 as default};
