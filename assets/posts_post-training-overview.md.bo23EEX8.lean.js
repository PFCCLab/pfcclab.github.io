import{_ as s,c as e,q as a,a as Q,N as T,o as l}from"./chunks/framework.BRsttz9t.js";const o="/assets/transformer.rzI-tLwx.png",r="/assets/transformer_illustrated.sc3Itf54.gif",d="/assets/decode_only_transformer.fggoTlgx.png",n="/assets/gpt_llama.Dy5SdzcJ.png",m="/assets/moe.D53mhZJY.gif",i="/assets/llm_overview.CcmMoujk.png",h="/assets/predict_next_token.CJ4LxVM1.png",p="/assets/post_train_methods.BDjPyS3Q.png",H="/assets/sft_process.CywbE_ve.png",g="/assets/lora.BO5r7XIS.png",V="/assets/dpo_process.B11-FSf_.png",c="/assets/dpo_loss.zex5zU8H.png",w="/assets/lol_1.BTafdCGx.png",L="/assets/lol_2.BsnybVc7.png",f="/assets/rl_process.Bizc9SuC.png",u="/assets/reward_model.lMf69COv.png",x="/assets/ppo_grpo.hgwk-BOw.png",y="/assets/rl_sft.CvWPzEsz.png",M="/assets/rl_sample_efficiency._2IXl1yK.png",k="/assets/rl_capacity.DeJFtde1.png",_3=JSON.parse('{"title":"Post-training of LLM（产品经理民科普及版）","description":"","frontmatter":{"title":"Post-training of LLM（产品经理民科普及版）","date":"2025-9-17","author":{"name":"孙师傅","github":"sunzhongkai588"},"category":"insights"},"headers":[],"relativePath":"posts/post-training-overview.md","filePath":"posts/post-training-overview.md"}'),Z={name:"posts/post-training-overview.md"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.835ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 14513 1000","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"88.298ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 39027.6 1000","aria-hidden":"true"},j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"58.427ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 25824.9 1000","aria-hidden":"true"},R={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.05ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12397.9 1000","aria-hidden":"true"},O={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"63.235ex",height:"5.475ex",role:"img",focusable:"false",viewBox:"0 -1460 27950 2420","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.335ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 10314.2 1000","aria-hidden":"true"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.518ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 10836.7 1000","aria-hidden":"true"},B={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.827ex"},xmlns:"http://www.w3.org/2000/svg",width:"85.547ex",height:"6.785ex",role:"img",focusable:"false",viewBox:"0 -1749.5 37811.6 2999","aria-hidden":"true"},q={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.292ex",height:"1ex",role:"img",focusable:"false",viewBox:"0 -431 571 442","aria-hidden":"true"},G={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.912ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.809ex",height:"2.869ex",role:"img",focusable:"false",viewBox:"0 -864.9 5661.4 1267.9","aria-hidden":"true"},J={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.281ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 566 899","aria-hidden":"true"},U={tabindex:"0"},K={style:{"text-align":"left"}},$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.136ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11552.2 1000","aria-hidden":"true"},Q1={style:{"text-align":"left"}},t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.01ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12380.4 1000","aria-hidden":"true"},a1={style:{"text-align":"left"}},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.458ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12136.2 1000","aria-hidden":"true"},s1={style:{"text-align":"left"}},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"29.331ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12964.4 1000","aria-hidden":"true"},d1={style:{"text-align":"center"}},n1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.827ex"},xmlns:"http://www.w3.org/2000/svg",width:"31.408ex",height:"6.785ex",role:"img",focusable:"false",viewBox:"0 -1749.5 13882.5 2999","aria-hidden":"true"},i1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.777ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.451ex",height:"2.949ex",role:"img",focusable:"false",viewBox:"0 -960 20973.4 1303.3","aria-hidden":"true"},p1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.256ex",height:"1.67ex",role:"img",focusable:"false",viewBox:"0 -716 1881 738","aria-hidden":"true"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.371ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 1048 705","aria-hidden":"true"},c1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.256ex",height:"1.67ex",role:"img",focusable:"false",viewBox:"0 -716 1881 738","aria-hidden":"true"},L1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"6.18ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 2731.4 716","aria-hidden":"true"},u1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.717ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 759 683","aria-hidden":"true"},y1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.697ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 750 716","aria-hidden":"true"},k1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"20.516ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 9067.9 1000","aria-hidden":"true"},b1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.228ex",height:"1.33ex",role:"img",focusable:"false",viewBox:"0 -431 984.6 588.1","aria-hidden":"true"},v1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.228ex",height:"1.33ex",role:"img",focusable:"false",viewBox:"0 -431 984.6 588.1","aria-hidden":"true"},j1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.824ex",height:"1.642ex",role:"img",focusable:"false",viewBox:"0 -431 1690.3 726","aria-hidden":"true"},R1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.31ex"},xmlns:"http://www.w3.org/2000/svg",width:"38.636ex",height:"3.751ex",role:"img",focusable:"false",viewBox:"0 -1078.9 17077.3 1657.8","aria-hidden":"true"},O1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.228ex",height:"1.33ex",role:"img",focusable:"false",viewBox:"0 -431 984.6 588.1","aria-hidden":"true"},S1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.228ex",height:"1.33ex",role:"img",focusable:"false",viewBox:"0 -431 984.6 588.1","aria-hidden":"true"},I1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.276ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3658.2 1000","aria-hidden":"true"},B1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.294ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 572 453","aria-hidden":"true"},q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.109ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 490 647","aria-hidden":"true"},G1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.893ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12328.6 1000","aria-hidden":"true"},J1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.587ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11751.6 1000","aria-hidden":"true"},U1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.893ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12328.6 1000","aria-hidden":"true"},$1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.587ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11751.6 1000","aria-hidden":"true"},Q3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.867ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 825.3 736.2","aria-hidden":"true"},T3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.042ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 902.4 599.8","aria-hidden":"true"},e3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.289ex",height:"2.363ex",role:"img",focusable:"false",viewBox:"0 -750 9409.7 1044.2","aria-hidden":"true"},s3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.475ex"},xmlns:"http://www.w3.org/2000/svg",width:"99.307ex",height:"4.076ex",role:"img",focusable:"false",viewBox:"0 -1149.5 43893.6 1801.6","aria-hidden":"true"},r3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.931ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5273.3 1000","aria-hidden":"true"},n3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.022ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6639.6 1000","aria-hidden":"true"},i3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.022ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6639.6 1000","aria-hidden":"true"},p3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.791ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6537.6 1000","aria-hidden":"true"},g3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.76ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 778 599.8","aria-hidden":"true"},c3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.972ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.192ex",height:"3.179ex",role:"img",focusable:"false",viewBox:"0 -975.6 6273 1405.2","aria-hidden":"true"},L3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.614ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.352ex",height:"4.744ex",role:"img",focusable:"false",viewBox:"0 -941.6 8553.8 2096.8","aria-hidden":"true"},u3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.437ex",height:"1.977ex",role:"img",focusable:"false",viewBox:"0 -716 1077 873.8","aria-hidden":"true"};function y3(M3,t,k3,Z3,b3,D3){return l(),e("div",null,[t[192]||(t[192]=a("",28)),Q("p",null,[Q("mjx-container",b,[(l(),e("svg",D,[...t[0]||(t[0]=[a("",1)])])),t[1]||(t[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"I"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"l"),Q("mi",null,"i"),Q("mi",null,"k"),Q("mi",null,"e"),Q("mo",null,"∣"),Q("mi",null,"I"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"c"),Q("mi",null,"a"),Q("mi",null,"t"),Q("mi",null,"s"),Q("mo",null,"∣"),Q("mi",null,"I"),Q("mtext",null," "),Q("mi",null,"l"),Q("mi",null,"i"),Q("mi",null,"k"),Q("mi",null,"e"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[193]||(t[193]=Q("p",null,"在训练中，为了优化这个目标，我们通常最小化其负对数似然：",-1)),Q("p",null,[Q("mjx-container",v,[(l(),e("svg",_,[...t[2]||(t[2]=[a("",1)])])),t[3]||(t[3]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"I"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"l"),Q("mi",null,"i"),Q("mi",null,"k"),Q("mi",null,"e"),Q("mo",null,"∣"),Q("mi",null,"I"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"c"),Q("mi",null,"a"),Q("mi",null,"t"),Q("mi",null,"s"),Q("mo",null,"∣"),Q("mi",null,"I"),Q("mtext",null," "),Q("mi",null,"l"),Q("mi",null,"i"),Q("mi",null,"k"),Q("mi",null,"e"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"I"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"l"),Q("mi",null,"i"),Q("mi",null,"k"),Q("mi",null,"e"),Q("mo",null,"∣"),Q("mi",null,"I"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"c"),Q("mi",null,"a"),Q("mi",null,"t"),Q("mi",null,"s"),Q("mo",null,"∣"),Q("mi",null,"I"),Q("mtext",null," "),Q("mi",null,"l"),Q("mi",null,"i"),Q("mi",null,"k"),Q("mi",null,"e"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[194]||(t[194]=a("",24)),Q("p",null,[Q("mjx-container",j,[(l(),e("svg",P,[...t[4]||(t[4]=[a("",1)])])),t[5]||(t[5]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"I"),Q("mo",null,"∣"),Q("mi",null,"P"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"m"),Q("mi",null,"p"),Q("mi",null,"t"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"like"),Q("mo",null,"∣"),Q("mi",null,"P"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"m"),Q("mi",null,"p"),Q("mi",null,"t"),Q("mo",null,","),Q("mtext",null,"I"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"cats"),Q("mo",null,"∣"),Q("mi",null,"P"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"m"),Q("mi",null,"p"),Q("mi",null,"t"),Q("mo",null,","),Q("mtext",null,"I like"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[195]||(t[195]=Q("p",null,"同样的，在训练中，为了优化这个目标，我们通常最小化其负对数似然，也就是最小化：",-1)),Q("p",null,[Q("mjx-container",R,[(l(),e("svg",C,[...t[6]||(t[6]=[a("",1)])])),t[7]||(t[7]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"R"),Q("mi",null,"e"),Q("mi",null,"s"),Q("mi",null,"p"),Q("mi",null,"o"),Q("mi",null,"n"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mo",null,"∣"),Q("mi",null,"P"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"m"),Q("mi",null,"p"),Q("mi",null,"t"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[196]||(t[196]=a("",11)),Q("mjx-container",O,[(l(),e("svg",A,[...t[8]||(t[8]=[a("",1)])])),t[9]||(t[9]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Good"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"ref")])])]),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Good"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")])]),Q("mo",null,">"),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Bad"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"ref")])])]),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Bad"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")])])])],-1))]),t[197]||(t[197]=Q("p",null,"其中：",-1)),Q("ul",null,[Q("li",null,[Q("mjx-container",S,[(l(),e("svg",F,[...t[10]||(t[10]=[a("",1)])])),t[11]||(t[11]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"R"),Q("mi",null,"e"),Q("mi",null,"s"),Q("mi",null,"p"),Q("mi",null,"o"),Q("mi",null,"n"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mo",null,"∣"),Q("mi",null,"P"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"m"),Q("mi",null,"p"),Q("mi",null,"t"),Q("mo",{stretchy:"false"},")")])],-1))]),t[12]||(t[12]=T(" 是当前微调后的模型在给定 prompt 下生成回复 response 的概率。",-1))]),Q("li",null,[Q("mjx-container",I,[(l(),e("svg",E,[...t[13]||(t[13]=[a("",1)])])),t[14]||(t[14]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"ref")])])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"R"),Q("mi",null,"e"),Q("mi",null,"s"),Q("mi",null,"p"),Q("mi",null,"o"),Q("mi",null,"n"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mo",null,"∣"),Q("mi",null,"P"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"m"),Q("mi",null,"p"),Q("mi",null,"t"),Q("mo",{stretchy:"false"},")")])],-1))]),t[15]||(t[15]=T(" 是参考模型（即原模型）在同一 prompt 下生成同一回复的概率。",-1))])]),t[198]||(t[198]=Q("p",null,"因此，DPO 的损失函数最终设计为：",-1)),Q("mjx-container",B,[(l(),e("svg",N,[...t[16]||(t[16]=[a("",1)])])),t[17]||(t[17]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"σ"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"-0.167em"})]),Q("mrow",{"data-mjx-texclass":"OPEN"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},"(")]),Q("mi",null,"β"),Q("mrow",{"data-mjx-texclass":"OPEN"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},"(")]),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Good"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"ref")])])]),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Good"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")])]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"0.278em"})]),Q("mo",null,"−"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"0.278em"})]),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Bad"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"ref")])])]),Q("mo",{stretchy:"false"},"("),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Bad"),Q("mtext",null," "),Q("mi",{"data-mjx-auto-op":"false"},"Response")]),Q("mo",null,"∣"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"Prompt")]),Q("mo",{stretchy:"false"},")")])]),Q("mrow",{"data-mjx-texclass":"CLOSE"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},")")]),Q("mrow",{"data-mjx-texclass":"CLOSE"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},")")])])],-1))]),t[199]||(t[199]=Q("p",null,"其中：",-1)),Q("ul",null,[Q("li",null,[Q("mjx-container",q,[(l(),e("svg",z,[...t[18]||(t[18]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D70E",d:"M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z",style:{"stroke-width":"3"}})])])],-1)])])),t[19]||(t[19]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"σ")])],-1))]),t[22]||(t[22]=T(" 为 Sigmoid 函数，",-1)),Q("mjx-container",G,[(l(),e("svg",X,[...t[20]||(t[20]=[a("",1)])])),t[21]||(t[21]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"σ"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mfrac",null,[Q("mn",null,"1"),Q("mrow",null,[Q("mn",null,"1"),Q("mo",null,"+"),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mi",null,"x")])])])])])],-1))]),t[23]||(t[23]=T("；",-1))]),Q("li",null,[Q("mjx-container",J,[(l(),e("svg",W,[...t[24]||(t[24]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FD",d:"M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z",style:{"stroke-width":"3"}})])])],-1)])])),t[25]||(t[25]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"β")])],-1))]),t[26]||(t[26]=T(" 为温度超参数，用以调节概率差的灵敏度。",-1))])]),t[200]||(t[200]=Q("p",null,"损失函数的值越小，说明模型在指定 Prompt 的条件下，生成好回复与坏回复的概率差越来越大，更偏向生成好回复，避免差回复。",-1)),t[201]||(t[201]=Q("p",null,"以下表格展示了 DPO 训练中涉及的概率计算步骤：",-1)),Q("table",U,[t[59]||(t[59]=Q("thead",null,[Q("tr",null,[Q("th",{style:{"text-align":"center"}},"步骤"),Q("th",{style:{"text-align":"left"}},"数学表达"),Q("th",{style:{"text-align":"center"}},"probability")])],-1)),Q("tbody",null,[Q("tr",null,[t[32]||(t[32]=Q("td",{style:{"text-align":"center"}},"1",-1)),Q("td",K,[t[29]||(t[29]=T("计算",-1)),t[30]||(t[30]=Q("strong",null,"微调模型",-1)),t[31]||(t[31]=T("的好回复概率 ",-1)),Q("mjx-container",$,[(l(),e("svg",Y,[...t[27]||(t[27]=[a("",1)])])),t[28]||(t[28]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"I like cats."),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[33]||(t[33]=Q("td",{style:{"text-align":"center"}},"0.5",-1))]),Q("tr",null,[t[39]||(t[39]=Q("td",{style:{"text-align":"center"}},null,-1)),Q("td",Q1,[t[36]||(t[36]=T("计算",-1)),t[37]||(t[37]=Q("strong",null,"参考模型",-1)),t[38]||(t[38]=T("的好回复概率 ",-1)),Q("mjx-container",t1,[(l(),e("svg",T1,[...t[34]||(t[34]=[a("",1)])])),t[35]||(t[35]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"ref")])])]),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"I like cats."),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[40]||(t[40]=Q("td",{style:{"text-align":"center"}},"0.1",-1))]),Q("tr",null,[t[46]||(t[46]=Q("td",{style:{"text-align":"center"}},"2",-1)),Q("td",a1,[t[43]||(t[43]=T("计算",-1)),t[44]||(t[44]=Q("strong",null,"微调模型",-1)),t[45]||(t[45]=T("的差回复概率 ",-1)),Q("mjx-container",e1,[(l(),e("svg",l1,[...t[41]||(t[41]=[a("",1)])])),t[42]||(t[42]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"I hate dogs."),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[47]||(t[47]=Q("td",{style:{"text-align":"center"}},"0.1",-1))]),Q("tr",null,[t[53]||(t[53]=Q("td",{style:{"text-align":"center"}},null,-1)),Q("td",s1,[t[50]||(t[50]=T("计算",-1)),t[51]||(t[51]=Q("strong",null,"参考模型",-1)),t[52]||(t[52]=T("的差回复概率 ",-1)),Q("mjx-container",o1,[(l(),e("svg",r1,[...t[48]||(t[48]=[a("",1)])])),t[49]||(t[49]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("msub",null,[Q("mi",null,"P"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-auto-op":"false"},"ref")])])]),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"I hate dogs."),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[54]||(t[54]=Q("td",{style:{"text-align":"center"}},"0.2",-1))]),Q("tr",null,[t[57]||(t[57]=Q("td",{style:{"text-align":"center"}},"3",-1)),t[58]||(t[58]=Q("td",{style:{"text-align":"left"}},"计算偏好损失",-1)),Q("td",d1,[Q("mjx-container",n1,[(l(),e("svg",m1,[...t[55]||(t[55]=[a("",1)])])),t[56]||(t[56]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"σ"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"-0.167em"})]),Q("mrow",{"data-mjx-texclass":"OPEN"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},"(")]),Q("mi",null,"β"),Q("mrow",{"data-mjx-texclass":"OPEN"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},"(")]),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mfrac",null,[Q("mn",null,"0.5"),Q("mn",null,"0.1")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"0.278em"})]),Q("mo",null,"−"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"0.278em"})]),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mfrac",null,[Q("mn",null,"0.1"),Q("mn",null,"0.2")]),Q("mrow",{"data-mjx-texclass":"CLOSE"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},")")]),Q("mrow",{"data-mjx-texclass":"CLOSE"},[Q("mo",{minsize:"2.470em",maxsize:"2.470em"},")")])])],-1))])])])])]),t[202]||(t[202]=a("",16)),Q("p",null,[Q("mjx-container",i1,[(l(),e("svg",h1,[...t[60]||(t[60]=[a("",1)])])),t[61]||(t[61]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"S"),Q("mi",null,"F"),Q("mi",null,"T")])]),Q("mo",null,"="),Q("mo",null,"−"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"N")])]),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"R"),Q("mi",null,"e"),Q("mi",null,"s"),Q("mi",null,"p"),Q("mi",null,"o"),Q("mi",null,"n"),Q("mi",null,"s"),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")")])]),Q("mo",null,"∣"),Q("mi",null,"P"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"m"),Q("mi",null,"p"),Q("msup",null,[Q("mi",null,"t"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[203]||(t[203]=a("",12)),Q("ul",null,[Q("li",null,[t[66]||(t[66]=Q("strong",null,"全参数微调 (Full Parameter Fine-Tuning)",-1)),t[67]||(t[67]=T("：直接更新模型的全部参数。更新参数的矩阵 ",-1)),Q("mjx-container",p1,[(l(),e("svg",H1,[...t[62]||(t[62]=[a("",1)])])),t[63]||(t[63]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",{mathvariant:"normal"},"Δ"),Q("mi",null,"W")])],-1))]),t[68]||(t[68]=T(" 和模型原始参数矩阵 ",-1)),Q("mjx-container",g1,[(l(),e("svg",V1,[...t[64]||(t[64]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D44A",d:"M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z",style:{"stroke-width":"3"}})])])],-1)])])),t[65]||(t[65]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"W")])],-1))]),t[69]||(t[69]=T(" 大小完全一致。这种方法常用且有效，但缺点是需要消耗更多的训练资源，训练与存储成本高。",-1))]),Q("li",null,[t[80]||(t[80]=Q("strong",null,"参数高效微调 (PEFT)",-1)),t[81]||(t[81]=T("：以 LoRA 为例，将更新参数的矩阵 ",-1)),Q("mjx-container",c1,[(l(),e("svg",w1,[...t[70]||(t[70]=[a("",1)])])),t[71]||(t[71]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",{mathvariant:"normal"},"Δ"),Q("mi",null,"W")])],-1))]),t[82]||(t[82]=T(" 分解为两个低秩矩阵 ",-1)),Q("mjx-container",L1,[(l(),e("svg",f1,[...t[72]||(t[72]=[a("",1)])])),t[73]||(t[73]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"B"),Q("mo",null,"×"),Q("mi",null,"A")])],-1))]),t[83]||(t[83]=T(" 相乘，并仅训练低秩矩阵 ",-1)),Q("mjx-container",u1,[(l(),e("svg",x1,[...t[74]||(t[74]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D435",d:"M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z",style:{"stroke-width":"3"}})])])],-1)])])),t[75]||(t[75]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"B")])],-1))]),t[84]||(t[84]=T(" 和 ",-1)),Q("mjx-container",y1,[(l(),e("svg",M1,[...t[76]||(t[76]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D434",d:"M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z",style:{"stroke-width":"3"}})])])],-1)])])),t[77]||(t[77]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A")])],-1))]),t[85]||(t[85]=T("。需要更新的参数量远少于全参微调 (",-1)),Q("mjx-container",k1,[(l(),e("svg",Z1,[...t[78]||(t[78]=[a("",1)])])),t[79]||(t[79]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{stretchy:"false"},"("),Q("mn",null,"2"),Q("mo",null,"×"),Q("mi",null,"d"),Q("mo",null,"×"),Q("mi",null,"r"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"<"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"d"),Q("mo",null,"×"),Q("mi",null,"d"),Q("mo",{stretchy:"false"},")")])],-1))]),t[86]||(t[86]=T(")，显著节省显存并加速训练。但另一方面，LoRA 的特点是“学习得更少，同时遗忘得更少 (Learns Less and Forgets Less)”。",-1))])]),t[204]||(t[204]=a("",14)),Q("p",null,[t[89]||(t[89]=T("经典的 RLHF（人类反馈强化学习）是先用人类偏好训练一个 reward model 来判断好坏，再在 KL 约束下用 PPO 等方法优化策略 ",-1)),Q("mjx-container",b1,[(l(),e("svg",D1,[...t[87]||(t[87]=[a("",1)])])),t[88]||(t[88]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])])])],-1))]),t[90]||(t[90]=T(" 去最大化该奖励。",-1))]),Q("p",null,[t[95]||(t[95]=T("DPO 证明了存在一个由策略 ",-1)),Q("mjx-container",v1,[(l(),e("svg",_1,[...t[91]||(t[91]=[a("",1)])])),t[92]||(t[92]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])])])],-1))]),t[96]||(t[96]=T(" 本身的对数概率（相对参考策略 ",-1)),Q("mjx-container",j1,[(l(),e("svg",P1,[...t[93]||(t[93]=[a("",1)])])),t[94]||(t[94]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"r"),Q("mi",null,"e"),Q("mi",null,"f")])])])],-1))]),t[97]||(t[97]=T("）构成的重参数化奖励，因此无需训练独立的奖励模型。对每个偏好对直接最小化：",-1))]),Q("p",null,[Q("mjx-container",R1,[(l(),e("svg",C1,[...t[98]||(t[98]=[a("",1)])])),t[99]||(t[99]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"σ"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"β"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mfrac",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"y"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p"),Q("mi",null,"o"),Q("mi",null,"s")])]),Q("mo",null,"∣"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"r"),Q("mi",null,"e"),Q("mi",null,"f")])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"y"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p"),Q("mi",null,"o"),Q("mi",null,"s")])]),Q("mo",null,"∣"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])]),Q("mo",null,"−"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mfrac",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"y"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"n"),Q("mi",null,"e"),Q("mi",null,"g")])]),Q("mo",null,"∣"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"r"),Q("mi",null,"e"),Q("mi",null,"f")])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"y"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"n"),Q("mi",null,"e"),Q("mi",null,"g")])]),Q("mo",null,"∣"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")")])],-1))])]),Q("p",null,[t[104]||(t[104]=T("也就是用策略 ",-1)),Q("mjx-container",O1,[(l(),e("svg",A1,[...t[100]||(t[100]=[a("",1)])])),t[101]||(t[101]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])])])],-1))]),t[105]||(t[105]=T(" 的相对对数概率差来“重参数化”奖励，再用对比式交叉熵直接训练策略 ",-1)),Q("mjx-container",S1,[(l(),e("svg",F1,[...t[102]||(t[102]=[a("",1)])])),t[103]||(t[103]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])])])],-1))]),t[106]||(t[106]=T("。这把“学奖励”转化为 ",-1)),t[107]||(t[107]=Q("strong",null,"“学策略相对参考策略的对数概率差”",-1)),t[108]||(t[108]=T(" ，实现更简单、训练更稳定。",-1))]),Q("p",null,[t[115]||(t[115]=T("其中，",-1)),Q("mjx-container",I1,[(l(),e("svg",E1,[...t[109]||(t[109]=[a("",1)])])),t[110]||(t[110]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"y"),Q("mo",null,"∣"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])],-1))]),t[116]||(t[116]=T(" 就是模型在给定 prompt ",-1)),Q("mjx-container",B1,[(l(),e("svg",N1,[...t[111]||(t[111]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D465",d:"M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z",style:{"stroke-width":"3"}})])])],-1)])])),t[112]||(t[112]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"x")])],-1))]),t[117]||(t[117]=T(" 下对回复 ",-1)),Q("mjx-container",q1,[(l(),e("svg",z1,[...t[113]||(t[113]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D466",d:"M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),t[114]||(t[114]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"y")])],-1))]),t[118]||(t[118]=T(" 的条件概率分布（也称“策略”/policy）。",-1))]),t[205]||(t[205]=Q("blockquote",null,[Q("p",null,[Q("em",null,[T("注：以上解释相对不严谨，具体信息参考论文原版 《"),Q("a",{href:"https://arxiv.org/abs/2305.18290",target:"_blank",rel:"noreferrer"},"Direct Preference Optimization: Your Language Model is Secretly a Reward Model"),T("》。")])])],-1)),t[206]||(t[206]=Q("h3",{id:"_3-loss-越低-模型效果会越好吗",tabindex:"-1"},[T("3. Loss 越低，模型效果会越好吗？ "),Q("a",{class:"header-anchor",href:"#_3-loss-越低-模型效果会越好吗","aria-label":'Permalink to "3. Loss 越低，模型效果会越好吗？"'},"​")],-1)),t[207]||(t[207]=Q("p",null,"一个常见误解是 DPO 的 loss 越低，模型效果就越好。实际上并非总是如此。",-1)),Q("p",null,[t[123]||(t[123]=T("只要同时降低好回复概率 ",-1)),Q("mjx-container",G1,[(l(),e("svg",X1,[...t[119]||(t[119]=[a("",1)])])),t[120]||(t[120]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"Good Response"),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))]),t[124]||(t[124]=T(" 和坏回复概率 ",-1)),Q("mjx-container",J1,[(l(),e("svg",W1,[...t[121]||(t[121]=[a("",1)])])),t[122]||(t[122]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"Bad Response"),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))]),t[125]||(t[125]=T("，但后者下降得更多，也能使 loss 变小。但这将导致好回复的绝对概率反而下降。",-1))]),t[208]||(t[208]=Q("p",null,"举个例子：",-1)),Q("ul",null,[Q("li",null,[Q("mjx-container",U1,[(l(),e("svg",K1,[...t[126]||(t[126]=[a("",1)])])),t[127]||(t[127]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"Good Response"),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))]),t[128]||(t[128]=T(" 从 0.5 -> ",-1)),t[129]||(t[129]=Q("strong",null,"0.25",-1))]),Q("li",null,[Q("mjx-container",$1,[(l(),e("svg",Y1,[...t[130]||(t[130]=[a("",1)])])),t[131]||(t[131]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"Bad Response"),Q("mo",null,"∣"),Q("mtext",null,"Prompt"),Q("mo",{stretchy:"false"},")")])],-1))]),t[132]||(t[132]=T(" 从 0.5 -> ",-1)),t[133]||(t[133]=Q("strong",null,"0.1",-1))])]),t[209]||(t[209]=a("",34)),Q("ol",null,[t[149]||(t[149]=Q("li",null,[T("一个 Prompt 有两个回复 "),Q("code",null,"J"),T("、"),Q("code",null,"K"),T("（已由人工评判好坏）同时输入到 Reward Model，使其预测人类偏好。")],-1)),Q("li",null,[t[138]||(t[138]=T("Reward Model 为每个回复计算奖励分数 ",-1)),Q("mjx-container",Q3,[(l(),e("svg",t3,[...t[134]||(t[134]=[a("",1)])])),t[135]||(t[135]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"j")])])],-1))]),t[139]||(t[139]=T("、",-1)),Q("mjx-container",T3,[(l(),e("svg",a3,[...t[136]||(t[136]=[a("",1)])])),t[137]||(t[137]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"k")])])],-1))]),t[140]||(t[140]=T("。",-1))]),Q("li",null,[t[143]||(t[143]=T("根据奖励分数和人工标签计算损失：",-1)),Q("mjx-container",e3,[(l(),e("svg",l3,[...t[141]||(t[141]=[a("",1)])])),t[142]||(t[142]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",null,"s"),Q("mo",null,"="),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"σ"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"j")]),Q("mo",null,"−"),Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"k")]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")")])],-1))]),t[144]||(t[144]=T("，表示“",-1)),t[145]||(t[145]=Q("code",null,"J",-1)),t[146]||(t[146]=T(" 比 ",-1)),t[147]||(t[147]=Q("code",null,"K",-1)),t[148]||(t[148]=T(" 更好”。",-1))]),t[150]||(t[150]=Q("li",null,"用该损失更新 Reward Model，使其能更准确地预测人类偏好。",-1))]),t[210]||(t[210]=a("",17)),Q("p",null,[Q("mjx-container",s3,[(l(),e("svg",o3,[...t[151]||(t[151]=[a("",1)])])),t[152]||(t[152]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"J")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"P"),Q("mi",null,"P"),Q("mi",null,"O")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"θ"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"double-struck"},"E")]),Q("mo",{stretchy:"false"},"["),Q("mi",null,"q"),Q("mo",null,"∼"),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mi",null,"o"),Q("mo",null,"∼"),Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"θ"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"o"),Q("mi",null,"l"),Q("mi",null,"d")])])])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"O"),Q("mo",null,"∣"),Q("mi",null,"q"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"]"),Q("mfrac",null,[Q("mn",null,"1"),Q("mrow",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mi",null,"o"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"t"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mi",null,"o"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),Q("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mfrac",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"t")]),Q("mo",null,"∣"),Q("mi",null,"q"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"<"),Q("mi",null,"t")])]),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"θ"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"o"),Q("mi",null,"l"),Q("mi",null,"d")])])])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"t")]),Q("mo",null,"∣"),Q("mi",null,"q"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"<"),Q("mi",null,"t")])]),Q("mo",{stretchy:"false"},")")])]),Q("msub",null,[Q("mi",null,"A"),Q("mi",null,"t")]),Q("mo",null,","),Q("mtext",null," clip"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mfrac",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"θ")])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"t")]),Q("mo",null,"∣"),Q("mi",null,"q"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"<"),Q("mi",null,"t")])]),Q("mo",{stretchy:"false"},")")]),Q("mrow",null,[Q("msub",null,[Q("mi",null,"π"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"θ"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"o"),Q("mi",null,"l"),Q("mi",null,"d")])])])]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"t")]),Q("mo",null,"∣"),Q("mi",null,"q"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"<"),Q("mi",null,"t")])]),Q("mo",{stretchy:"false"},")")])]),Q("mo",null,","),Q("mn",null,"1"),Q("mo",null,"−"),Q("mi",null,"ϵ"),Q("mo",null,","),Q("mn",null,"1"),Q("mo",null,"+"),Q("mi",null,"ϵ"),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("msub",null,[Q("mi",null,"A"),Q("mi",null,"t")]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")])])],-1))])]),t[211]||(t[211]=Q("h4",{id:"_2-grpo-group-relative-policy-optimization",tabindex:"-1"},[T("(2) GRPO, Group Relative Policy Optimization "),Q("a",{class:"header-anchor",href:"#_2-grpo-group-relative-policy-optimization","aria-label":'Permalink to "(2) GRPO, Group Relative Policy Optimization"'},"​")],-1)),Q("p",null,[t[155]||(t[155]=T("GRPO 的关键点是组内相对比较：对于同一 prompt ",-1)),t[156]||(t[156]=Q("code",null,"q",-1)),t[157]||(t[157]=T("，一次生成一个 group 的多条候选回复 ",-1)),Q("mjx-container",r3,[(l(),e("svg",d3,[...t[153]||(t[153]=[a("",1)])])),t[154]||(t[154]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{fence:"false",stretchy:"false"},"{"),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"1")]),Q("mo",null,","),Q("mo",null,"…"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"G")]),Q("mo",{fence:"false",stretchy:"false"},"}")])],-1))]),t[158]||(t[158]=T("，以组内的相对表现作为优势信号，取代 PPO 网络中对 Value Model 的依赖。",-1))]),t[212]||(t[212]=Q("p",null,[Q("strong",null,"GRPO 训练流程"),T("：")],-1)),Q("ol",null,[Q("li",null,[t[161]||(t[161]=Q("strong",null,"采样 (Sampling)",-1)),t[162]||(t[162]=T("：准备一个 batch 的 prompts ",-1)),t[163]||(t[163]=Q("code",null,"q",-1)),t[164]||(t[164]=T("，将 ",-1)),t[165]||(t[165]=Q("code",null,"q",-1)),t[166]||(t[166]=T(" 喂给 Policy Model。针对每个 ",-1)),t[167]||(t[167]=Q("code",null,"q",-1)),t[168]||(t[168]=T("，Policy Model 生成一个 group 的 response ",-1)),Q("mjx-container",n3,[(l(),e("svg",m3,[...t[159]||(t[159]=[a("",1)])])),t[160]||(t[160]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{fence:"false",stretchy:"false"},"{"),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"1")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"…"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"G")]),Q("mo",{fence:"false",stretchy:"false"},"}")])],-1))]),t[169]||(t[169]=T("。",-1))]),Q("li",null,[t[174]||(t[174]=Q("strong",null,"评估 (Evaluation)",-1)),t[175]||(t[175]=T("：使用 Reward Model 对每个生成结果 ",-1)),Q("mjx-container",i3,[(l(),e("svg",h3,[...t[170]||(t[170]=[a("",1)])])),t[171]||(t[171]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{fence:"false",stretchy:"false"},"{"),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"1")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"…"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"G")]),Q("mo",{fence:"false",stretchy:"false"},"}")])],-1))]),t[176]||(t[176]=T(" 进行评分，得到奖励 ",-1)),Q("mjx-container",p3,[(l(),e("svg",H3,[...t[172]||(t[172]=[a("",1)])])),t[173]||(t[173]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{fence:"false",stretchy:"false"},"{"),Q("msub",null,[Q("mi",null,"r"),Q("mn",null,"1")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"r"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"…"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"G")]),Q("mo",{fence:"false",stretchy:"false"},"}")])],-1))]),t[177]||(t[177]=T("。",-1))]),Q("li",null,[t[186]||(t[186]=Q("strong",null,"更新 (Update)",-1)),t[187]||(t[187]=T("：根据每个回复的奖励 ",-1)),Q("mjx-container",g3,[(l(),e("svg",V3,[...t[178]||(t[178]=[a("",1)])])),t[179]||(t[179]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"i")])])],-1))]),t[188]||(t[188]=T(" 与组内平均奖励 ",-1)),Q("mjx-container",c3,[(l(),e("svg",w3,[...t[180]||(t[180]=[a("",1)])])),t[181]||(t[181]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"r"),Q("mo",{stretchy:"false"},"¯")])]),Q("mo",null,"="),Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"G")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"G")])]),Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"j")])])],-1))]),t[189]||(t[189]=T(" 来计算相对优势 ",-1)),Q("mjx-container",L3,[(l(),e("svg",f3,[...t[182]||(t[182]=[a("",1)])])),t[183]||(t[183]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"A"),Q("mi",null,"i")]),Q("mo",null,"="),Q("mfrac",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"i")]),Q("mo",null,"−"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"r"),Q("mo",{stretchy:"false"},"¯")])])]),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"G")]),Q("munder",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"r"),Q("mi",null,"j")]),Q("mo",null,"−"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"r"),Q("mo",{stretchy:"false"},"¯")])]),Q("msup",null,[Q("mo",{stretchy:"false"},")"),Q("mn",null,"2")]),Q("mo",null,"+"),Q("mi",null,"ϵ")])])])],-1))]),t[190]||(t[190]=T("，并根据相对优势 ",-1)),Q("mjx-container",u3,[(l(),e("svg",x3,[...t[184]||(t[184]=[a("",1)])])),t[185]||(t[185]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"A"),Q("mi",null,"i")])])],-1))]),t[191]||(t[191]=T(" 和对应算法，以及 Reference Model 的 KL 惩罚，更新 Policy Model。",-1))])]),t[213]||(t[213]=a("",21))])}const j3=s(Z,[["render",y3]]);export{_3 as __pageData,j3 as default};
